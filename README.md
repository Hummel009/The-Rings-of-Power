The Rings of Power - простенький мод, который добавляет 20 колец власти в Minecraft. Кольца имеют эффекты на нахождение в инвентаре и клик ПКМ. Мод рассматривается как тематические дополнение к моду "Властелин колец", хотя мод независим и не требует установки каких-либо других модов.

Приведённая ниже документация будет полезна как разработчикам, так и мне самому из будущего. Сведения, гайды, подводные камни, советы и всё такое. Обязательно прочитайте, здесь есть уникальная информация, которой больше нигде нет.

## Общая информация 

Этот репозиторий содержит множество папок, каждая из них - это проект Gradle, который должен быть открыт через IntelliJ IDEA или импортирован в Eclipse IDE.

| Версия          | Синтаксис Java  | Версия Gradle | Плагин сборки                     | Версия JDK                  |
|-----------------|-----------------|---------------|-----------------------------------|-----------------------------|
| 1.3.2 - 1.6.4   | 6               | 7.6           | Voldeloom 2.4                     | Eclipse Temurin 11.0.20     |
| 1.7.10          | 8               | 8.4           | ForgeGradle Anatawa12's 1.2-1.1.+ | Eclipse Temurin 1.8.0_392   |
| 1.8.9           | 8               | 2.14          | ForgeGradle 2.1-SNAPSHOT          | Eclipse Temurin 1.8.0_392   |
| 1.9.4 - 1.11.2  | 8               | 2.14          | ForgeGradle 2.2-SNAPSHOT          | Eclipse Temurin 1.8.0_392   |
| 1.12.2 - 1.16.5 | 8               | 8.1.1         | ForgeGradle 6.0.14,6.2            | Eclipse Temurin 1.8.0_392   |
| 1.17.1          | 16              | 8.1.1         | ForgeGradle 6.0.14,6.2            | Eclipse Temurin 16.0.2      |
| 1.18.2 и новее  | 17              | 8.1.1         | ForgeGradle 6.0.14,6.2            | Eclipse Temurin 17.0.8      |

Обязательно проконтролируйте, чтобы ваш синтаксис Java и ваша JDK были такими, как сказано выше. Издатель JDK может отличаться, главное, чтобы соответствовала версия. Ваша IDE и переменные среды вашей ОС должны быть правильно сконфигурированы, иначе ничего не будет работать.

* JDK, сконфигурированный в IDE, отвечает за то, какие синтаксические конструкции есть в языке и какой на выходе получится байткод (который должен быть совместим с ожиданиями Forge).
* Синтаксис, сконфигурированный в IDE, отвечает за то, какие конструкции языка вы можете использовать (чтобы случайно не получить на выходе байткод, который будет нечитаемым и крашнет Forge). В некоторых случаях вы можете выбрать более новую JDK и более старый синтаксис, чтобы ограничить себя.
* JDK, сконфигурированный в переменных средах ОС, отвечает за то, какой джавой будет запущена сборка мода и загрузка среды.
* JDK в Eclipse называется `JRE/JDK`, в IntelliJ IDEA - `SDK`. Синтаксис в Eclipse называется `Compiler Compliance Level`, в IntelliJ IDEA - `Language Level`.

### Где это настраивать?

* Переменные среды Windows:
  * Первый способ: `ЛКМ по "Мой компьютер" -> Свойства -> Дополнительные параметры системы -> Переменные среды`.
  * Второй способ: `Параметры -> Система -> О системе -> Дополнительные параметры системы -> Переменные среды`.
  * Когда вы всё-таки добрались до переменных сред, создайте там две переменные: `JAVA_HOME` и `Path`. Если они уже существуют, то двойным нажатием ЛКМ откройте их и посмотрите содержимое.
    * В JAVA_HOME должна быть только одна строка, содержащая путь к вашей JDK. У меня это `C:\Users\Hummel009\.jdks\temurin-1.8.0_392`.
    * В Path, помимо других строк, должна быть как минимум одна строка, содержащая путь вашей JDK\bin. У меня это `C:\Users\Hummel009\.jdks\temurin-1.8.0_392\bin`.
* Eclipse IDE:
  * Сверху справа находится лупа, через которую можно попасть куда угодно.
    * Для настройки синтаксиса введите в поиск `Compliance` и откройте предложенный `Compiler`. Там сверху выставляется число.
    * Для настройки JDK введите в поиск `Installed JREs` и откройте предложенный  `Installed JREs | Open the preferences dialog`. Там вы можете нажать на текущую JRE и удалить её (`Remove`), чтобы потом добавить (`Add`) новую `Standard VM` и указать место на диске, где лежит ваша JDK, после чего подтвердить и выбрать её.
  * Альтернативный способ добраться до настроек синтаксиса и JDK - это сверху нажать `Window -> Preferences -> Java` и там выбрать либо `Compiler`, либо `Installed JREs`.
  * Если у вас в среде много проектов, вы можете настроить каждый отдельно. Для этого нажмите слева на проект и сверху пройдите по пути `Project -> Properties` (а не `Window -> Preferences`). Там есть `Java Build Path` и `Java Compiler`.
    * `Java Compiler` - просто окно, где сверху выставляется число.
    * `Java Build Path` - окно с вкладками, где вас интересует вкладка `Libraries`. Там нужно нажать по центру на `Module path`, а затем нажать справа `Add Library -> JRE System Library`. Там вы можете указать одну из добавленных ранее в `Installed JREs`.
* IntelliJ IDEA:
  * `Ctrl + Alt + Shift + S` приведёт вас к структуре проекта, где вы настраиваете SDK и Language Level.
  * `Ctrl + Alt + S`, а затем `Build... -> Compiler -> Java Compiler` приведёт вас к настройкам Language Level в среде разработки.
  * `Ctrl + Alt + S`, а затем `Build... -> Build Tools -> Gradle -> Gradle JVM` приведёт вас к настройкам переменных сред в среде разработки. Это на случай, если для запуска Gradle нужна JDK, отличающаяся от той, что указана в переменных средах ОС.
  * Альтернативный способ добраться до структуры проекта или настроек среды - это нажать на шестерёнку сверху справа и выбрать там `Project Structure` или `Settings`.
  * Ещё один альтернативный способ найти настройки среды - нажать `File -> Settings`.
  
## Гайд по установке и работе

Собственно, для начала нужно скачать и разархивировать куда-то папку с исходниками. Будем называть это **папкой проекта**. В ней лежат папки (gradle, src) и различные файлы.

### Версии 1.3.2 - 1.6.4

Эти версии вышли более десяти лет назад, и с тех пор все инструменты для разработки уже устарели и недоступны для скачивания. Однако разработку на них вести всё ещё можно, если использовать Voldeloom - аналог ForgeGradle, позволяющий вести разработку на устаревших версиях.

* Первым делом, необходимо открыть проект Gradle в среде.
  * В случае Eclipse IDE импортируйте папку проекта: `File -> Import -> Gradle -> Existing Gradle Project -> Next -> [Выбираете папку] -> Finish`.
  * В случае IntelliJ IDEA откройте папку проекта: `File -> Open -> [Выбираете папку]`.
* Чтобы запустить мод из среды, выполните Gradle Task `runClient`.
  * В случае Eclipse IDE откройте поиск (лупа сверху справа) и введите там `Gradle`, после чего нажмите на предложенный ответ `Gradle Tasks`. Снизу появится панель, там нужно выбрать `Volde -> runClient`.
  * В случае IntelliJ IDEA нажмите на значок слона сверху справа. Справа появится панель, там нужно выбрать `Volde -> runClient`.
  * Есть и другие способы. Например, открыть консоль Windows в папке проекта и ввести там `gradlew runClient`.
  * Если есть проблемы с открытием консоли, можно создать файл с расширением .bat в папке проекта, открыть его при помощи блокнота и написать внутри `gradlew runClient`, после чего запускать процесс двойным нажатием ЛКМ по файлу.
* После первого запуска игра может открыться без мода, это норма. Во второй раз всё будет нормально.
* Компилировать мод отдельно не нужно - Voldeloom сам компилирует его перед каждым `runClient`.
* Таким образом, после каждого запуска игры из среды новейшая версия вашего мода лежит по пути `папка_проекта/build/libs`. Важно: там лежит два файла, но вас интересует тот, который без приписки `-dev`.

### Версии 1.7.10 - 1.11.2

Эти версии вышли достаточно давно, и с тех пор все инструменты для разработки уже устарели. К счастью, они ещё работают. Тем не менее, уже на момент создания они были неидеальны и требовали костыли. Костыли реализуются созданием файлов IDE.

* В папке проекта есть два файла с расширением .bat, `setupEclipse` и `setupIdea`. Выберите нужный, запустите двойным нажатием ЛКМ по нему, подождите окончания.
  * Под капотом файлов с расширением .bat лежат команды консоли Windows, `gradlew setupDecompWorkspace eclipse` и `gradlew setupDecompWorkspace idea`, соответственно. Если желаете взять процесс в свои руки и не полагаться на эти файлы, можете вместо их запуска открыть в папке проекта консоль Windows и ввести там эти команды руками. Смысл файлов, скорее, не в экономии времени, а в напоминании о том, что эта версия требует костыль.
* После окончания генерации среды импортируйте сгенерированный проект IDE. ***Именно проект IDE! Это не проект Gradle.***
  * В случае Eclipse IDE импортируйте папку проекта: `File -> Import -> General -> Existing Projects into Workspace -> Next -> [Выбираете папку] -> Finish`.
  * В случае IntelliJ IDEA двойным нажатием ЛКМ откройте файл `.ipr` в папке проекта. Загрузку скриптов Gradle нужно пропустить (`skip`). Когда инициализация закончится, крайне рекомендуется в меню `File -> Manage IDE Settings` конвертировать проект `.ipr` в `Directory-based format`, иначе багов и зависаний не миновать.
* Чтобы запустить мод из среды, используйте следующий подход:
  * В случае IntelliJ IDEA уже сгенерированы две конфигурации запуска, клиент и сервер (в верхней части окна). Сервер не работает, это норма. Клиент запускается с недостаточным количеством памяти. Это можно исправить, нажав на название запуска, а затем на `Edit Configurations`. Замените `1024` на `2048` (как минимум).
  * В случае Eclipse IDE придётся самостоятельно создать новую конфигурацию запуска. Это делается возле зелёного кружочка запуска в верхней части окна - там правее есть чёрный треугольник, при нажатии на который можно увидеть выпадающее меню и там пункт `Run Configurations`. Нажмите на пункт, затем выберите слева `Java Application` и нажмите сверху слева на белый документ. Появляется ненастроенный запуск. Настройте его.
    * В первой вкладке (сверху) укажите проект - это папка, для которой мы создаём запуски.
    * В первой вкладке (ниже) укажите файл входа - это `GradleStart`.
    * Во вкладке `Arguments` (сверху) выделите память: `-Xincgc -Xmx2G -Xms2G`.
    * Во вкладке `Arguments` (снизу) укажите рабочую папку (в ней будут миры майнкрафта и прочие файлы игры). Например, создайте в скачанном репозитории папку `run` и укажите её, как рабочую.
    * Сохраните.
* Чтобы скомпилировать мод в файл с расширением .jar, используйте следующий подход:
  * В случае Eclipse IDE откройте консоль Windows в папке среды и введите `gradlew build`. Альтернатива - создайте файл `build.bat`, откройте его блокнотом, впишите туда команду `gradlew build`, сохраните, запустите двойным нажатием ЛКМ.
  * В случае IntelliJ IDEA можно применить способ Eclipse, но есть и более красивый способ. Создайте собственный Gradle Task с командой `build` на вашем проекте и выполните его. Как это сделать:
    * Нажмите на название уже сгенерированного запуска в верхней части окна.
    * В выпадающем меню нажмите на `Edit Configurations`.
    * Слева сверху нажмите на значок плюса, а затем - на `Gradle` в появившемся меню.
    * Под словом `Run` напишите `build`.
    * Сохраните снизу, нажав на "ОК".
    * Для компиляции выберите тот запуск, который вы только что создали, и запустите его зелёной кнопкой запуска (треугольник).
* После того, как вы запустите сборку одним из способов выше, произойдёт компиляция, а ваш мод появится в папке `папка_проекта/build/libs`.

### Версии 1.12.2 и новее

Эти версии вышли недавно и они уже рассчитаны на упрощённый запуск без костылей.

* Первым делом, необходимо открыть проект Gradle в среде.
  * В случае Eclipse IDE импортируйте папку проекта: `File -> Import -> Gradle -> Existing Gradle Project -> Next -> [Выбираете папку] -> Finish`.
  * В случае IntelliJ IDEA откройте папку проекта: `File -> Open -> [Выбираете папку]`.
* Чтобы запустить мод из среды, необходимо сгенерировать конфигурации запуска.
  * В случае Eclipse IDE откройте поиск (лупа сверху справа) и введите там `Gradle`, после чего нажмите на предложенный ответ `Gradle Tasks`. Снизу появится панель, там нужно выбрать `Forgegradle Runs -> runClient`.
  * В случае IntelliJ IDEA нажмите на значок слона сверху справа. Справа появится панель, там нужно выбрать `Forgegradle Runs -> runClient`.
  * Есть и другие способы. Например, открыть консоль Windows в папке проекта и ввести там `gradlew genEclipseRuns` или `gradlew genIntellijRuns`.
  * Если есть проблемы с открытием консоли, можно создать файл с расширением .bat в папке проекта, открыть его при помощи блокнота и написать внутри `gradlew genEclipseRuns` или `gradlew genIntellijRuns`, после чего запускать процесс двойным нажатием ЛКМ по файлу.
* После генерации конфигураций запуска их можно применять.
  * В случае Eclipse IDE нажмите сверху на чёрный треугольник возле зелёного кружочка запуска, а затем нажмите на нужный запуск.
  * В случае IntelliJ IDEA нажмите сверху на название запуска, затем в открывшемся списке выберите нужный и нажмите на зелёный треугольник справа от него.
* Чтобы скомпилировать мод в файл с расширением .jar, используйте следующий подход, используйте Gradle Task `build` из категории build. Аналогично способу генерации запусков, вы можете использовать консоль или файл с расширением .bat.
* После того, как вы запустите сборку одним из способов выше, произойдёт компиляция, а ваш мод появится в папке `папка_проекта/build/libs`.

## Примечания

Вы можете всё сделать правильно, но при этом ничего не будет работать. Это бывает редко, но, тем не менее, бывает.

* Eclipse иногда, ввиду плохого интернета, может повредить скачиваемый файл и настройка среды сорвётся. И потом никогда не починится. Придётся всё сделать через IntelliJ IDEA, а уже потом импортировать среду в Eclipse.
* Версия 1.12.2 может не запускаться или не иметь текстур в IntelliJ IDEA, но в Eclipse всё будет нормально.

## Папка Forges

В этой папке я храню свои пропатченные версии Forge и Voldeloom. В чём их преимущество?

* Я постарался унифицировать сборочные машины, версии плагинов сборки и так далее. Получается очень приличная экономия интернета и места на диске.
* Более новые сборочные машины "умрут" не так скоро, как устаревшие, так что разработка на этих версиях будет жить дольше.